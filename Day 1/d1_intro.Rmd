---
title: "Shiny Workshop: Day 1"
output: 
  html_document:
    theme: yeti
    highlight: tango

---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
raw_data <- read.csv("data/raw_data.csv")
```

<style>
h1, h2, h3, h4 {font-weight: bold;}
.question {font-weight: bold; color: #4E23B8;}
hr {border: 2px solid black;}
a:link {color: white; text-decoration: none;}
a:visited {color: white; text-decoration: none;}
a:hover {color: #c9bde9; text-decoration: none;}
a:active {color: white; text-decoration: none;}
.panel-aims {color: white; background-color: #4E23B8; border-top: 3px solid black; border-bottom: 3px solid black; padding-left: 15px; padding-right: 15px; } 
.panel-section {color: black; background-color: #c9bde9; border-top: 3px solid black; border-bottom: 3px solid black; padding-left: 15px; padding-right: 15px; } 
</style>

<!--- ---------------------------------------------------------------------- -->
<!--- Aims section -->

<br>
<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-aims"> <!--- Begin panel -->
<h3>Aims</h3>
<ul>
<li><a href="#1.1">1.1 Get to know your data.</a></li>
<li><a href="#1.2">1.2 Become comfortable with data subsetting and summarising.</a></li>
<li><a href="#1.3">1.3 Build exploratory plots.</a></li>
<li><a href="#1.4">1.4 Introduce rShiny.</a></li>
</ul>
<br>
If you'd like to view a specific section of the document, click on the aim above.  
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

<!--- ---------------------------------------------------------------------- -->
<!--- 1.1. Getting to know your data -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.1">1.1 &nbsp; Getting to know your data</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

<p class="question">Install and load in the libraries and data we need for this section:</p>
``` {r, eval=FALSE}
# Set your working directory by clicking on the top menu:
# Session > Set Working Directory > To Source File Location

# Install packages
install.packages("dplyr")

# Load in libraries
library(dplyr)

# If you are want to read the information for a function, type 1 question mark in front of the function name:
?read.csv

# If you are want to know which package a function belongs to, type 2 question marks in front of the function name:
??read.csv

# Load in data
raw_data <- read.csv("data/raw_data.csv") 

```

<h4> Viewing your data </h4>

<ul>
<li> Highlight use of View(), summary(), head(), tail() </li>
</ul>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.2. Data subsetting, grouping and summarising -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.2">1.2 &nbsp; Data subsetting and summarising</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

During this workshop, we will use functions available in the `` dplyr `` package to subset and summarise data.  

<br>

<h4> dplyr </h4>
dplyr functions can use the `` %>% `` (pipe) operator to chain together objects/functions. This passes the output of one function directly into the next. It can be helpful to 'stack' multiple functions without creating multiple visible outputs. You'll see this in use in the following examples.

<br>

<h4> Subsetting </h4>
Subsetting is commonly used in R to select data that you would like to use. The `` select `` function can be used to subset based on column name.  

<p class="question">Compare the results of using the function normally vs. with the pipe operator:</p>
```{r, eval=FALSE}
select(raw_data, Age, Region)

raw_data %>% 
  select(Age, Region)
```

The `` filter `` function can be used to subset based on variables in your data.

<p class="question">What do each of these lines of code filter the data for?</p>
```{r, eval=FALSE}
raw_data %>% 
  filter(Region == "Mara")

raw_data %>% 
  filter(Age >= 30)
```

These outputs can be saved as an object, exactly as you normally would.  

<p class="question">Store your output table as an object:</p>
```{r, eval=FALSE}
# Save output as an object
subsetted_data <- raw_data %>% 
  filter(Region == "Mara")

# Print table
subsetted_data
```

<br>

<h4> Summarising </h4>
Sometimes, you may want to work with summaries of your data. The `` summarise `` function can be used to calculate summaries of variables in your data.  

<p class="question">What do each of the following filters summarise?</p>
```{r, eval=FALSE}
raw_data %>% 
  summarise(n_males = length(which(Sex=="M")))

raw_data %>% 
  summarise(total_age = sum(Age))
```

As mentioned earlier, dplyr functions can be stacked using the `` %>% `` (pipe) operator. For example, the `` summarise `` function can be combined with `` group_by `` to summarise variables by one or more columns.  

<p class="question">How are these two tables different?</p>
```{r, eval=FALSE}
raw_data %>% 
  group_by(Sex) %>% 
  summarise(n_records = length(Sex))

raw_data %>% 
  group_by(Region, Sex) %>% 
  summarise(total_age = sum(Age))
```

<br>

<h4> Summary </h4>
 <p class="question"> Which function would you use for the following? Fill the blanks! </p>
```{r, eval=FALSE}
# Subset for only records with a dog 
raw_data %>%
  ___(species=="dog")
```

<!--- ---------------------------------------------------------------------- -->
<!--- 1.3. Build some exploratory plots -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.3">1.3 &nbsp; Build some exploratory plots</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->


<ul>
<li>Introduce alternative plot methods baseR/ggplot2/leaflet</li>
</ul>
<br>


<!--- ---------------------------------------------------------------------- -->
<!--- 1.4. Introducing rShiny -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4">1.4 &nbsp; Introducing rShiny</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

<ul>
<li>Provide template for simple layout</li>
<li>Use exploratory plots</li>
<li>Introduce reactive elements/inputs/widgets</li>
<li>Single pane app with no tabs</li>
</ul>
<br>
