---
title: "Data Visualisation using RShiny: Day 1"
author: "Building an interactive plot in RShiny"
date: "1.4 Worksheet"
output: 
  html_document:
    theme: yeti
    highlight: tango

---

<style>
h1, h2, h3, h4 {font-weight: bold;}
.blue {color: #4E23B8;}
hr {border: 2px solid black;}
a.title:link {color: white; text-decoration: none;}
a.title:visited {color: white; text-decoration: none;}
a.title:hover {color: #c9bde9; text-decoration: none;}
a.title:active {color: white; text-decoration: none;}
a.main:link {color: #4E23B8; text-decoration: none;}
a.main:visited {color: #4E23B8; text-decoration: none;}
a.main:hover {color: #4E23B8; font-weight: bold; text-decoration: none;}
a.main:active {color: #4E23B8; text-decoration: none;}
.panel-aims {color: white; background-color: #4E23B8; border-top: 3px solid black; border-bottom: 3px solid black; padding-left: 15px; padding-right: 15px; } 
.panel-section {color: black; background-color: #c9bde9; border-top: 3px solid black; border-bottom: 3px solid black; padding-left: 15px; padding-right: 15px; } 
</style>

```{r, echo=FALSE}
library(kableExtra)
```

<!--- ---------------------------------------------------------------------- -->
<!--- Contents section -->

<br>
<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-aims"> <!--- Begin panel -->
<h3>Contents</h3>
Click to view a specific section of the document.  
<br>
<ul>
<li><a class="title" href="#1.4a">1.4a Create a shiny app</a></li>
<li><a class="title" href="#1.4b">1.4b Add an option to a radio button widget</a></li>
<li><a class="title" href="#1.4c">1.4c Add a new text output</a></li>
<li><a class="title" href="#1.4d">1.4d Make a simple change to the data used by a widget</a></li>
<li><a class="title" href="#1.4e">1.4e Make a more complicated change to the data used by a widget </a></li>
<li><a class="title" href="#1.4f">1.4f Change a widget</a></li>
<li><a class="title" href="#1.4g">1.4g Explore a "Go" button</a></li>
</ul>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4a. Create a shiny app -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4a">1.4a &nbsp; Create a shiny app</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

<h4 class="blue">Activity: Create an app in a single R script</h4>
<ol>
<li> Open up R Studio </li>
<li> On the top menu, click on:  </li>
&nbsp;&nbsp; File > New File > Shiny Web App  
<li> Type in a name for your app, click on <em>Single File (app.R)</em>, check you are happy with the directory, then click Create! </li> 
<li> Click on the <img src="figures/run.png" style="display: inline-block; margin: 0" /> button to run the code and load the app </li>
</ol> 
<br>
<h4 class="blue">Activity: Create an app using multiple R scripts</h4>
<ol>
<li> On the top menu, click on:  </li>
&nbsp;&nbsp; File > New File > Shiny Web App  
<li> Type in a name for your app, click on <em>Multiple File (ui.R/server.R)</em>, check you are happy with the directory, then click Create! </li> 
<li> Run the app as before </li>
</ol>
<br>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4b. Add an option to a radio button widget -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4b">1.4b &nbsp; Add an option to a radio button widget</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

Please navigate to the <b class="blue">Apps/barplot_1</b> folder and open up the <b class="blue">ui.R</b> and <b class="blue">server.R</b> scripts in R Studio.
<br><br>
This is a simple app that uses our dataset to show a barplot.
<br>
There is only 1 widget - ``selectInput()`` - to show a Dropdown menu that selects a variable to show on the x-axis.
<br><br>
Please take a moment to have a look at the server and ui scripts, then run the app.
<br>
We've added comments to the 2 scripts to help explain what the code does, but some of it should be familiar from earlier.
<br><br>
<h4 class="blue">Activity: Add age as an option  to view on the x-axis</h4>
<br>
<em>
Hints:
<ul>
<li>You only need to change the ui file</li>
<li>Remember to explore the dataset to find the correct column name</li>
</ul>
</em>
<br>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4c. Add a new text output -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4c">1.4c &nbsp; Add a new text output</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

Please navigate to the <b class="blue">Apps/barplot_2</b> folder and open up the <b class="blue">ui.R</b> and <b class="blue">server.R</b> scripts in R Studio.
<br><br>
This is the same simple barplot app as before, but with a new ``verbatimtextOutput()`` below.
<br>
<em>Verbatim</em> simply mean "as is"" - it prints the output to look like ``code``.
<br><br>
Please take a moment to have a look at the server and ui scripts, then run the app.
<br><br>
<h4 class="blue">Questions: </h4>
<ol>
<li>How many inputs does the app use?</li>
<li>How many outputs/renders does the app use?</li>
</ol>
<br>
<h4 class="blue">Activity: Add another text output to the side panel</h4>
<br>
<em>
Hints:
<ul>
<li>You will need to change both files</li>
<li>You could show a summary of your data e.g. ``head()``, ``summary()``</li>
<li>You can reference the input as a column name using a set of double square brackets e.g. ``raw_data[[input$new_text]]``</li>
</ul>
</em>
<br>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4d. Make a simple change to the data used by a widget -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4d">1.4d &nbsp; Make a simple change to the data used by a widget</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

Please navigate to the <b class="blue">Apps/Day 1 - timeseries_1</b> folder and open up the <b class="blue">ui.R</b> and <b class="blue">server.R</b> scripts in R Studio.
<br><br>
This is a new app that shows a timeseries plot with a Dropdown menu, which allows the user to select the species plotted. There is an option for "All species", but if the user selects another option, "All species" is still plotted.
<br><br>
Please take a moment to have a look at the server and ui scripts, then run the app.
<br><br>
<h4 class="blue">Questions: </h4>
<ol>
<li>What function is used to subset in the ``reactive()`` function?</li>
<li>What does the ``|``mean in the ``reactive()`` function?</li>
</ol>
<br>
<h4 class="blue">Activity: Change the dropdown from Species to Region  </h4>
<br>
<em>
Hints:
<ul>
<li>You will need to change both files</li>
<li>We have named objects descriptively e.g. ``input$select_species``; use this to identify where you should make edits</li>
</ul>
</em>
<br>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4e. Make a more complicated change to the data used by a widget -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4e">1.4e &nbsp; Make a more complicated change to the data used by a widget</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

Please navigate to the <b class="blue">Apps/Day 1 - timeseries_2</b> folder and open up the <b class="blue">ui.R</b> and <b class="blue">server.R</b> scripts in R Studio.
<br><br>
This is the same timeseries app as before, but with a new ``checkboxGroupInput()`` below.
<br><br>
Please take a moment to have a look at the server and ui scripts, then run the app.
<br><br>
<h4 class="blue">Questions: </h4>
<ol>
<li>Why do we create categories for "All data", "Both sexes" and "All regions" when summarising the data?</li>
<li>In the ``checkboxGroupInput()`` function in the ui, we provide a list for the choices given to the user.  
Which of these (Male, Female, M, F) are present in the data, and which have we set to appear in the app?</li>
</ol>
<br><h4 class="blue">Activity: Change the checkboxes from Sex to Species  </h4>
<br>
<em>
Hints:
<ul>
<li>You will need to change both files</li>
<li>When listing options for the widgets, you can provide a list (e.g. ``region_list``) or set the choices manually (e.g. ``list("Dog"="dog", "Cat"="cat"...``))</li>
<li>For checkboxes, you do not need an option for "Select all" in the ui because the user can automatically select multiple options</li>
</ul>
</em>
<br>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4f. Change a widget -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4f">1.4f &nbsp; Change a widget</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

Please navigate to the <b class="blue">Apps/Day 1 - timeseries_3</b> folder and open up the <b class="blue">ui.R</b> and <b class="blue">server.R</b> scripts in R Studio.
<br><br>
This is the same timeseries app as before, but with a new ``sliderInput()`` below the others.
<br><br>
Please take a moment to have a look at the server and ui scripts, then run the app.
<br><br>
<h4 class="blue">Questions: </h4>
<ol>
<li>What does the ``<=`` mean in the ``reactive()`` function?</li>
<li>What does the ``value`` argument in the ``sliderInput()`` set?</li>
</ol>
<br><h4 class="blue">Activity: Change from a 1-sided to a 2-sided slider  </h4>
<br>
<em>
Hints:
<ul>
<li>You will need to change both files</li>
<li>Remember to use the ``?`` to view a helpfile if you are stuck</li>
<li>If an input produces multiple values, they appear in the ui as a character string (vector)</li>
</ul>
</em>
<br>

<!--- ---------------------------------------------------------------------- -->
<!--- 1.4ag Explore a "Go" button -->

<div class="row"> <!--- Setup grid for layout -->
<div class="col-md-12"> <!--- Begin column set -->
<div class="panel panel-section"> <!--- Begin panel -->
<h3 id="1.4g">1.4g &nbsp; Explore a "Go" button</h3>
</div> <!--- End panel -->
</div> <!--- End column set -->
</div> <!--- End grid -->

Please navigate to the <b class="blue">Apps/Day 1 - timeseries_4</b> folder and open up the <b class="blue">ui.R</b> and <b class="blue">server.R</b> scripts in R Studio.
<br><br>
This is the same timeseries app as before, but with 2 new ``actionButton()`` below the others.
<br><br>
Please take a moment to have a look at the server and ui scripts, then run the app.
<br><br>
<h4 class="blue">Questions: </h4>
We'll discuss this app as a group, so please take a moment to think about these questions:
<ol>
<li>What reactive elements have changed in the ui code and the server code?  </li>
<li>Can you spot any new functions in the shinyServer that we have not introduced yet? What do these do?</li>
<li>Can you think of any scenarios where it would be helpful to use an ``actionButton()`` to trigger a reactive event?</li>
</ol>
<br>
